<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>English Flashcards</title>
<style>
  :root {
    --primary-color: #6DA7F2;
    --bg-light: rgba(109, 167, 242, 0.1);
  }

  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    padding: 30px;
    max-width: 800px;
    margin: auto;
    color: #333;
  }

  h1 {
    text-align: center;
    color: var(--primary-color);
  }

  /* ë²„íŠ¼ ë° ì»¨íŠ¸ë¡¤ ìŠ¤íƒ€ì¼ */
  .controls {
    text-align: center;
    margin-bottom: 20px;
  }

  button {
    border: 1px solid var(--primary-color);
    background-color: white;
    color: var(--primary-color);
    padding: 8px 16px;
    cursor: pointer;
    border-radius: 4px;
    transition: 0.3s;
    font-weight: bold;
  }

  button:hover {
    background-color: var(--bg-light);
  }

  .input-row {
    display: flex;
    gap: 10px;
    margin-bottom: 25px;
  }

  input {
    flex: 1;
    padding: 10px;
    border: 1px solid var(--primary-color);
    border-radius: 4px;
    outline: none;
  }

  /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
  table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--primary-color);
  }

  th {
    background-color: var(--bg-light);
    border: 1px solid var(--primary-color);
    padding: 12px;
  }

  td {
    border: 1px solid var(--primary-color);
    padding: 10px;
    text-align: center;
    position: relative;
  }

  /* ê°€ë¦¬ê¸° ìŠ¤íƒ€ì¼ */
  .hidden {
    background-color: #f9f9f9;
    color: transparent !important;
    cursor: pointer;
  }
  .hidden::after {
    content: "í´ë¦­í•´ì„œ ë³´ê¸°";
    color: #aaa;
    font-size: 0.8em;
  }

  /* ì•¡ì…˜ ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
  .action-buttons {
    display: flex;
    flex-direction: column;
    gap: 5px;
    align-items: center;
    justify-content: center;
  }

  .icon-btn {
    border: none;
    background: none;
    cursor: pointer;
    font-size: 18px;
    padding: 2px;
    color: var(--primary-color);
  }

  .icon-btn:hover {
    transform: scale(1.2);
    background: none;
  }

  .csv-btn {
    margin-top: 20px;
    background-color: var(--bg-light);
  }
</style>
</head>
<body>

<h1>English Flashcards</h1>

<div class="controls">
  <button id="modeToggleBtn" onclick="rotateMode()">ëª¨ë“œ ë³€ê²½: ë‘˜ ë‹¤ ë³´ê¸°</button>
</div>

<div class="input-row">
  <input id="sentenceInput" placeholder="ì˜ì–´ ë¬¸ì¥">
  <input id="meaningInput" placeholder="ëœ»">
  <button onclick="addRow()">ë“±ë¡</button>
</div>

<table>
  <thead>
    <tr>
      <th style="width: 40%;">ë¬¸ì¥</th>
      <th style="width: 40%;">ëœ»</th>
      <th style="width: 10%;">ê´€ë¦¬</th>
    </tr>
  </thead>
  <tbody id="tableBody"></tbody>
</table>

<div style="text-align: right;">
  <button class="csv-btn" onclick="exportToCSV()">CSV íŒŒì¼ë¡œ ì €ì¥(ë‹¤ìš´ë¡œë“œ)</button>
</div>

<script>
let modeIndex = 0;
const modes = ["both", "sentence", "meaning"];
const modeLabels = ["ë‘˜ ë‹¤ ë³´ê¸°", "ë¬¸ì¥ë§Œ ë³´ê¸°", "ëœ»ë§Œ ë³´ê¸°"];

// ë°ì´í„° ë°°ì—´ (ë¡œì»¬ ì €ì¥ì†Œì—ì„œ ë¶ˆëŸ¬ì˜´)
let cardData = JSON.parse(localStorage.getItem('flashcards')) || [];

// ì´ˆê¸° ë¡œë“œ
window.onload = () => {
  renderTable();
};

// ëª¨ë“œ ì „í™˜ í•¨ìˆ˜
function rotateMode() {
  modeIndex = (modeIndex + 1) % modes.length;
  document.getElementById('modeToggleBtn').innerText = `ëª¨ë“œ ë³€ê²½: ${modeLabels[modeIndex]}`;
  renderTable();
}

// ë°ì´í„° ì¶”ê°€
function addRow() {
  const sentence = document.getElementById('sentenceInput').value.trim();
  const meaning = document.getElementById('meaningInput').value.trim();

  if (!sentence || !meaning) {
    alert("ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return;
  }

  cardData.push({ sentence, meaning });
  saveAndRender();
  
  document.getElementById('sentenceInput').value = "";
  document.getElementById('meaningInput').value = "";
}

// ë°ì´í„° ìˆ˜ì •
function editRow(index) {
  const newSentence = prompt("ë¬¸ì¥ì„ ìˆ˜ì •í•˜ì„¸ìš”:", cardData[index].sentence);
  const newMeaning = prompt("ëœ»ì„ ìˆ˜ì •í•˜ì„¸ìš”:", cardData[index].meaning);
  
  if (newSentence !== null && newMeaning !== null) {
    cardData[index] = { sentence: newSentence, meaning: newMeaning };
    saveAndRender();
  }
}

// ë°ì´í„° ì‚­ì œ
function deleteRow(index) {
  if (confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
    cardData.splice(index, 1);
    saveAndRender();
  }
}

// ì €ì¥ ë° ë¦¬ë Œë”ë§
function saveAndRender() {
  localStorage.setItem('flashcards', JSON.stringify(cardData));
  renderTable();
}

// í…Œì´ë¸” ê·¸ë¦¬ê¸°
function renderTable() {
  const tbody = document.getElementById('tableBody');
  tbody.innerHTML = "";

  cardData.forEach((item, index) => {
    const tr = document.createElement("tr");
    
    const currentMode = modes[modeIndex];
    const sClass = (currentMode === "meaning") ? "hidden" : "";
    const mClass = (currentMode === "sentence") ? "hidden" : "";

    tr.innerHTML = `
      <td class="${sClass}" onclick="this.classList.remove('hidden')">${item.sentence}</td>
      <td class="${mClass}" onclick="this.classList.remove('hidden')">${item.meaning}</td>
      <td>
        <div class="action-buttons">
          <button class="icon-btn" onclick="editRow(${index})" title="ìˆ˜ì •">âœ</button>
          <button class="icon-btn" onclick="deleteRow(${index})" title="ì‚­ì œ">ğŸ—‘</button>
        </div>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

// CSV ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥
function exportToCSV() {
  if (cardData.length === 0) {
    alert("ì €ì¥í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }

  let csvContent = "\uFEFF"; // UTF-8 BOM (í•œê¸€ ê¹¨ì§ ë°©ì§€)
  csvContent += "Sentence,Meaning\n";
  
  cardData.forEach(row => {
    csvContent += `"${row.sentence}","${row.meaning}"\n`;
  });

  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");
  link.setAttribute("href", url);
  link.setAttribute("download", "flashcards.csv");
  link.style.visibility = 'hidden';
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}
</script>

</body>
</html>
